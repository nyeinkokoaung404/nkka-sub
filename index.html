<!DOCTYPE html>
<html lang="fa">

<head>
  <meta charset="UTF-8">
  <title>{{ user.username }} Info</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;900&display=swap" rel="stylesheet">
  
  <link href="https://cdn.jsdelivr.net/gh/MuhammadAshouri/marzban-templates@master/template-01/build.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.6/flowbite.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
  
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/gh/MuhammadAshouri/marzban-templates@master/template-01/qrcode.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.12.1/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs-i18n@2.4.0/dist/cdn.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@ryangjchandler/alpine-clipboard@2.2.0/dist/alpine-clipboard.js"></script>
   
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      background: #fefce8;
      font-family: "Vazirmatn", sans-serif;
      line-height: normal;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      direction: ltr;
    }
    .profile-card {
      position: relative;
      border: 2px solid #000;
      border-radius: 1rem;
      background: #fff;
      width: 20rem;
      margin-top: 6rem;
      margin-bottom: 2rem;
    }
    .profile-card::before,
    .profile-card::after {
      content: "";
      position: absolute;
      inset: 0;
      background: #fff;
      border: 2px solid #000;
      border-radius: 1rem;
      z-index: -1;
      transition: transform 200ms ease-out;
    }
    .profile-card:hover::before {
      transform: rotate(-3deg) scale(1.02) translate(-1%);
    }
    .profile-card:hover::after {
      transform: rotate(-6deg) scale(1.02) translate(-1%);
      z-index: -2;
      transition-delay: 100ms;
    }
    .profile-card__avatar {
      width: 80px;
      height: 80px;
      position: absolute;
      border: 2px solid #000;
      -o-object-fit: cover;
      object-fit: cover;
      box-shadow: 0 2px 0 #000;
      top: 0;
      left: 50%;
      transform: translate(-50%, -80%);
      border-radius: 1rem;
    }
    .profile-card__bio {
      background: #fef9c3;
      padding: 2rem;
      border-bottom: 2px dashed #000;
      text-align: center;
      border-radius: 1rem 1rem 0 0;
      overflow: hidden;
    }
    .profile-card__bio-name {
      font-size: 1.25em;
      font-weight: 900;
      margin-bottom: 0.8rem;
    }
    .profile-card__bio-title {
      font-size: 0.875em;
      font-weight: 600;
      margin-bottom: 0.6rem;
    }
    .profile-card__links {
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      overflow: hidden;
    }
    .profile-card__header {
      text-align: right;
      font-size: 1.25em;
      font-weight: bold;
      color: #000;
      display: flex;
      -webkit-box-pack: justify;
      justify-content: right;
      cursor: pointer;
    }
    .profile-card__header::after {
      content: "\276F";
      width: 1rem;
      height: 1rem;
      text-align: center;
      -webkit-transition: all 0.3s;
      transition: all 0.3s;
    }
    input {
      position: absolute;
      opacity: 0;
      z-index: -1;
    }
    .accordion {
      width: 100%;
      overflow: hidden;
    }
    .accordion:last-child {
      margin-bottom: 0;
    }
    .accordion-content {
      max-height: 0;
      padding: 0 1rem;
      -webkit-transition: all 0.3s;
      transition: all 0.3s;
    }
    input:checked+.profile-card__header::after {
      -webkit-transform: rotate(90deg);
      transform: rotate(90deg);
    }
    input:checked~.accordion-content {
      max-height: 100vh;
      padding: 16px;
    }
    .profile-card__separator {
      border-bottom: 2px dashed #000;
      border-radius: 1rem 1rem 0 0;
      overflow: hidden;
    }
    .profile-card__links-button {
      padding: 1rem;
      display: inline-block;
      width: 100%;
      text-align: center;
      border: 2px solid #000;
      border-radius: 0.5rem;
      color: #000;
      transition: box-shadow 200ms ease;
      text-decoration: none;
      margin-bottom: 0.5rem;
    }
    .profile-card__links-button:hover {
      box-shadow: -3px 3px 0 #000;
    }
    .progressBarContainer {
      margin-top: 15px;
      position: relative;
    }
    .progressBar {
      background-color: #000;
      width: 100%;
      height: 18px;
      padding: 2px;
      border-radius: 50px;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    .progressBarRect {
      background-image: linear-gradient(90deg, #f98400 0%, #fbc118 100%);
      height: 100%;
      padding: 2px;
      border-radius: inherit;
      -webkit-animation: progressLineTransmission 2.5s 0.3s ease-in-out both;
      animation: progressLineTransmission 2.5s 0.3s ease-in-out both;
      display: flex;
      align-items: center;
      justify-content: flex-end;
    }
    .progressBarCircle {
      background-color: #fff;
      height: calc(14px - 4px);
      width: calc(14px - 4px);
      border-radius: 50%;
      box-shadow: rgba(0, 0, 0, 0.16) 0 1px 4px;
    }
    .progressBarPoint {
      color: #000;
      margin-top: 8px;
      font-size: 12px;
      font-weight: 900;
      position: absolute;
    }
    .progressBarPoint--start {
      right: 0;
    }
    .progressBarPoint--end {
      left: 0;
    }
    @-webkit-keyframes progressLineTransmission {
      from {
        width: 5%;
      }
      to {
        width: {% if user.data_limit %}{{ [(user.used_traffic / user.data_limit) * 100, 5] | max }}%{% else %}100%{% endif %};
      }
    }
    @keyframes progressLineTransmission {
      from {
        width: 5%;
      }
      to {
        width: {% if user.data_limit %}{{ [(user.used_traffic / user.data_limit) * 100, 5] | max }}%{% else %}100%{% endif %};
      }
    }
        
        h1 {
            text-align: center;
            color: #fff;
            margin-bottom: 20px;
            font-size: 24px;
            animation: rgbAnimation 3s infinite alternate;
        }
        @keyframes rgbAnimation {
            0% { color: #ff0000; } /* Red */
            25% { color: #00ff00; } /* Green */
            50% { color: #0000ff; } /* Blue */
            75% { color: #ffff00; } /* Yellow */
            100% { color: #ff00ff; } /* Magenta */
        }
  </style>

</head>

<body>
  <div class="profile-card">
    <img alt="Avatar Image" class="profile-card__avatar" src="https://images.weserv.nl/?url=https://iam404.serv00.net/404.png?v=4&amp;h=300&amp;w=300&amp;fit=cover&amp;maxage=7d&amp;bg=000">
    <div class="profile-card__bio">
      <h1 class="profile-card__bio-name"> Username: {{ user.username }}</h1>
      <h4 style="text-align: center; font-weight: bold;"><span style="color: #f40125">P</span><span style="color: #00FF00">o</span><span style="color: #f27401">w</span><span style="color: #008080">e</span><span style="color: #f27401">r</span><span style="color: #f3a101">e</span><span style="color: #FF00FF">d</span><span style="color: #1cfd00">&nbsp;</span><span style="color: #1cfd00">&nbsp;</span><span style="color: #f90083">B</span><span style="color: #0000ff">y</span><span style="color: #1cfd00">&nbsp;</span><font color="#00ff00">4-0-4</font></h4>
      <h1 class="profile-card__bio-name"> {{ user.status.value }} </h1>
      <h2 class="profile-card__bio-title"> Volume consumed: {{ user.used_traffic | bytesformat }}</h2>
      {% if user.data_limit_reset_strategy != 'no_reset' %}
      <h2 class="profile-card__bio-title" style="direction: ltr;">
        (resets every {{ user.data_limit_reset_strategy.value }})
      </h2>
      {% endif %}
      <h2 class="profile-card__bio-title"> Total volume: {% if not user.data_limit %}∞{% else %}{{ user.data_limit | bytesformat }}{% endif %}</h2>
      <h2 class="profile-card__bio-title"> Remaining time:
        {% if not user.expire and not user.on_hold_expire_duration %}
        ∞
        {% else %}
            {% if user.status.value == 'on_hold' %}
              {% set remaining_seconds = [user.on_hold_expire_duration, 0] | max %}
            {% else %}
              {% set current_timestamp = now().timestamp() %}
              {% set remaining_seconds = [user.expire - current_timestamp, 0] | max %}
            {% endif %}
            {% set remaining_days = remaining_seconds // (24 * 3600) %}
            {% set remaining_hours = (remaining_seconds % (24 * 3600)) // 3600 %}
            {% set remaining_minutes = (remaining_seconds % 3600) // 60 %}
            {% if remaining_days >= 1 %}
                {{ remaining_days | int }} day {{ remaining_hours | int }} hour
            {% else %}
                {{ remaining_hours | int }} hour {{ remaining_minutes | int }} minutes
            {% endif %}
        {% endif %}
      </h2>
      <div class="progressBarContainer">
        <div class="progressBar">
          <div class="progressBarRect">
            <span class="progressBarCircle"></span>
          </div>
        </div>
        <span class="progressBarPoint progressBarPoint--start">{% if not user.data_limit %}∞{% else %}{{ user.data_limit | bytesformat }}{%
                                    endif %}</span>
        <span class="progressBarPoint progressBarPoint--end">{{ user.used_traffic | bytesformat
                                    }}</span>
      </div>
    </div>
    <div class="profile-card__links">
      <div class="accordion">
        <input type="checkbox" name="quick-add" id="quick-add">
        <label class="profile-card__header" for="quick-add">
          Quick add subscription link
        </label>
        <div class="accordion-content">
          <a class="profile-card__links-button" href="hiddify://import/{{ user.subscription_url }}#{{ user.username }}" rel="noopener noreferrer" target="_blank">Add to hiddify</a>
          <a class="profile-card__links-button" href="sing-box://import-remote-profile?url=/sub/{{ user.subscription_url }}#{{ user.username }}" rel="noopener noreferrer" target="_blank">Add to sing-box</a>
          <a class="profile-card__links-button" href="v2box://install-sub?url={{ user.subscription_url }}&name={{ user.username }}" rel="noopener noreferrer" target="_blank">Add to V2BOX</a>
          <a class="profile-card__links-button" href="v2rayng://install-config?url=/sub/{{ user.subscription_url }}" rel="noopener noreferrer" target="_blank">Add to v2rayNG</a>
          <a class="profile-card__links-button" href="sn://subscription?url=/sub/{{ user.subscription_url }};name={{ user.username }}" rel="noopener noreferrer" target="_blank">Add to NekoBox</a>
          <a class="profile-card__links-button" href="streisand://import/{{ user.subscription_url | urlencode }}" rel="noopener noreferrer" target="_blank">Add to Streisand</a>
          <a class="profile-card__links-button" href="foxray://yiguo.dev/sub/add/?url={{ user.subscription_url | urlencode }}#{{ user.username }}" rel="noopener noreferrer" target="_blank">Add to FoXray</a>
          
        </div>
      </div>
      <div class="profile-card__separator"></div>
  <h1 class="profile-card__bio-name"> Contact to developer </h1>
      <div class="accordion">
        <input type="checkbox" name="dev" id="dev">
        <label class="profile-card__header" for="dev">
          If there are any problems with subscription, please contact on Telegram (or) Facebook.
        </label>
        <div class="accordion-content">
          <a class="profile-card__links-button" href="https://t.me/nkka404" rel="noopener noreferrer" target="_blank">Telegram</a>
          <a class="profile-card__links-button" href="https://www.facebook.com/www.nyeinkokoaung.2015" rel="noopener noreferrer" target="_blank">Facebook</a>
        </div>
      </div>
      <div class="profile-card__separator"></div>
      
  <script>
        const dataLimit = "{% if not user.data_limit %}∞{% else %}{{ user.data_limit }}{% endif %}";
        const dataUsed = "{{ user.used_traffic }}";
        const expireDateInit = "{% if user.status.value == 'on_hold' %}-{% elif not user.expire %}∞{% else %}{% set current_timestamp = now().timestamp() %}{{ user.expire | datetime }}{% endif %}";
        var tmpUsage = ( ( parseFloat( dataUsed ) / parseFloat( dataLimit ) ) * 100 ).toFixed( 2 );
        if ( tmpUsage > 100 ) tmpUsage = 100;
        const dataUsage = dataLimit == "∞" ? 100 : tmpUsage;
        const dataChartColor = dataUsage < 40 ? "bg-green-600" : dataUsage < 80 ? "bg-yellow-600" : "bg-red-500";
        const resetInterval = "{{ user.data_limit_reset_strategy.value }}";
        let expireDateVar = expireDateInit.includes( "∞" ) ? "∞" : localStorage.getItem( "lang" ) == "fa" ? new Date( expireDateInit ).toLocaleString( "fa-IR-u-nu-latn" ).replace( ",", " " ) : expireDateInit;
        let appsJson = {
            IOS: {
                SingBox: {
                    url: [
                        {
                            name: "IOS 15+",
                            url: "https://apps.apple.com/us/app/sing-box/id6451272673",
                            best: false,
                        },
                    ],
                    tutorial: "",
                    autoImport: "sing-box://import-remote-profile?url=",
                },
                Streisand: {
                    url: [
                        {
                            name: "IOS 14+",
                            url: "https://apps.apple.com/us/app/streisand/id6450534064",
                            best: false,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/streisand.MP4",
                    autoImport: "streisand://install-config?url=",
                },
                FoXray: {
                    url: [
                        {
                            name: "IOS 16+",
                            url: "https://apps.apple.com/us/app/foxray/id6448898396",
                            best: false,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/foxray.mp4",
                    autoImport: "foxray://install-config?url=",
                },
                V2Box: {
                    url: [
                        {
                            name: "IOS 14+",
                            url: "https://apps.apple.com/us/app/v2box-v2ray-client/id6446814690",
                            best: true,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/v2box.MP4",
                    autoImport: "v2box://install-config?url=",
                },
                Shadowrocket: {
                    url: [
                        {
                            name: "$3.99",
                            url: "https://apps.apple.com/ca/app/shadowrocket/id932747118",
                            best: false,
                        },
                    ],
                    tutorial: "",
                    autoImport: "",
                },
            },
            Android: {
                SingBox: {
                    url: [
                        {
                            name: "",
                            url: "https://github.com/SagerNet/sing-box/releases/download/v1.9.0-rc.3/SFA-1.9.0-rc.3-universal.apk",
                            best: true,
                        }
                    ],
                    tutorial: "",
                    autoImport: "sing-box://import-remote-profile?url=",
                },
                v2rayNG: {
                    url: [
                        {
                            name: "GooglePlay",
                            url: "https://play.google.com/store/apps/details?id=com.v2ray.ang",
                            best: true,
                        },
                        {
                            name: "Github",
                            url: "https://github.com/2dust/v2rayNG/releases/download/1.8.18/v2rayNG_1.8.18.apk",
                            best: false,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/v2rayNG.mp4",
                    autoImport: "v2rayng://install-config?url=",
                },
                NekoBox: {
                    url: [
                        {
                            name: "Arm64",
                            url: "https://github.com/MatsuriDayo/NekoBoxForAndroid/releases/download/1.3.1/NB4A-1.3.1-arm64-v8a.apk",
                            best: false,
                        },
                        {
                            name: "Armeabi",
                            url: "https://github.com/MatsuriDayo/NekoBoxForAndroid/releases/download/1.3.1/NB4A-1.3.1-armeabi-v7a.apk",
                            best: false,
                        },
                    ],
                    tutorial: "",
                    autoImport: "nekobox://install-config?url=",
                },
                HiddifyNext: {
                    url: [
                        {
                            name: "",
                            url: "https://github.com/hiddify/hiddify-next/releases/download/v1.0.0/Hiddify-Android-universal.apk",
                            best: false,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/hiddify.mp4",
                    autoImport: "",
                },
            },
            Windows: {
                SingBox: {
                    url: [
                        {
                            name: "",
                            url: "https://github.com/SagerNet/sing-box/releases/download/v1.9.0-rc.3/sing-box-1.9.0-rc.3-windows-amd64.zip",
                            best: false,
                        },
                    ],
                    tutorial: "",
                    autoImport: "",
                },
                nekoray: {
                    url: [
                        {
                            name: "",
                            url: "https://github.com/MatsuriDayo/nekoray/releases/download/3.26/nekoray-3.26-2023-12-09-windows64.zip",
                            best: false,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/nekoray.MP4",
                    autoImport: "",
                },
                v2rayN: {
                    url: [
                        {
                            name: "",
                            url: "https://github.com/2dust/v2rayN/releases/download/6.39/zz_v2rayN-With-Core-SelfContained.7z",
                            best: true,
                        },
                    ],
                    tutorial: "https://github.com/MuhammadAshouri/marzban-template-tutorial/raw/master/v2rayN.MP4",
                    autoImport: "",
                },
            },
        };
        let langJson = {
            en: {
                active: "Active",
                limited: "Limited",
                expired: "Expired",
                disabled: "Disabled",
                onHold: "On hold",
                dataUsage: "Data Usage: ",
                expirationDate: "Expiration Date: ",
                resetIntervalDay: "(Resets Every Day)",
                resetIntervalWeek: "(Resets Every Week)",
                resetIntervalMonth: "(Resets Every Month)",
                resetIntervalYear: "(Resets Every Year)",
                remainingDays: "Remaining Days: ",
                remainingDaysSufix: " Days",
                links: "Links",
                apps: "Apps",
                tutorials: "Tutorials",
                subscription: "Subscription",
                language: "Language",
                settings: "Settings",
                darkMode: "Dark mode",
                copyAll: "Copy All",
                proxy: "Proxy",
                tutorial: "Tutorial",
                download: "Download",
                support: "Telegram Support",
                import: "Import to app",
                autoImport: "Auto Import",
            },
            fa: {
                active: "فعال",
                limited: "تمام شده",
                expired: "پایان یافته",
                disabled: "غیرفعال",
                onHold: "در انتظار",
                dataUsage: "مصرف داده: ",
                expirationDate: "تاریخ پایان: ",
                resetIntervalDay: "(ریست روزانه)",
                resetIntervalWeek: "(ریست هفتگی)",
                resetIntervalMonth: "(ریست ماهانه)",
                resetIntervalYear: "(ریست سالانه)",
                remainingDays: "روزهای باقی‌مانده: ",
                remainingDaysSufix: " روز",
                links: "لینک‌ها",
                apps: "برنامه‌ها",
                tutorials: "آموزش‌ها",
                subscription: "لینک اشتراک",
                language: "زبان",
                settings: "تنظیمات",
                darkMode: "تم تیره",
                copyAll: "کپی همه",
                proxy: "پروکسی",
                tutorial: "آموزش",
                download: "دانلود",
                support: "پشتیبانی تلگرام",
                import: "افزودن به نرم افزار",
                autoImport: "افزودن خودکار",
            },
        };
        let settings = {
            darkMode: 1,
            language: "en",
            support: "", // can be telegram's support username link (exp: https://t.me/gozargah_marzban)
            proxy: "", // hides proxy button
            //proxy: "tg://socks?server=127.0.0.1&port=2085", // opens telegram directly
            //proxy: "https://t.me/socks?server=127.0.0.1&port=2085",  // opens telegram in browser,
            autoImportUserLink: getUserOSLink()
        };

        document.addEventListener( "alpine:init", () =>
        {
            settings.darkMode = localStorage.getItem( "dark" ) ?? settings.darkMode;
            localStorage.setItem( "dark", settings.darkMode );
        } );

        document.addEventListener( "alpine-i18n:ready", () =>
        {
            window.AlpineI18n.fallbackLocale = "en";
            let locale = localStorage.getItem( "lang" ) ?? settings.language;
            window.AlpineI18n.create( locale, langJson );
            AlpineI18n.locale = locale;
            document.body.setAttribute( "dir", locale == "fa" ? "rtl" : "ltr" );
            if ( locale == "fa" ) $( document.body ).addClass( "font-[Vazirmatn]" );
            else $( document.body ).removeClass( "font-[Vazirmatn]" );
        } );

        function getUserOSLink ()
        {
            var platform = navigator.platform.toLowerCase();

            if ( platform.indexOf( 'win' ) !== -1 ) return appsJson.Windows.v2rayN.autoImport;
            else if ( platform.indexOf( 'iphone' ) !== -1 || platform.indexOf( 'ipad' ) !== -1 || platform.indexOf( 'ipod' ) !== -1 || platform.indexOf( 'mac' ) !== -1 ) return appsJson.IOS.V2Box;
            else if ( platform.indexOf( 'android' ) !== -1 || platform.indexOf( 'linux arm' ) !== -1 ) return appsJson.Android.v2rayNG.autoImport;
            else return '';
        }
    </script>


                <div class="shadow-box-shadow rounded-lg p-5 mt-7" x-data>
                    <div class="mb-4 border-b border-gray-200 dark:border-gray-700">
                        <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="main-tab" data-tabs-toggle="#tabs-content" role="tablist">
                            
                           <li class="flex-1" role="presentation">
                                <button class="inline-block w-full p-4 border-b-2 rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 transition" id="apps-tab" data-tabs-target="#apps" type="button" role="tab" aria-controls="apps" aria-selected="false" x-text="$t('apps')"></button>
                            </li>
                          <li class="flex-1" role="presentation">
                                <button class="inline-block p-4 border-b-2 rounded-t-lg w-full transition" id="profile-tab" data-tabs-target="#links" type="button" role="tab" aria-controls="links" aria-selected="false" x-text="$t('links')"></button>
                            </li>
                        </ul>
                    </div>
                    <div id="tabs-content">
                        <div class="hidden" id="links" role="tabpanel" aria-labelledby="links-tab">
                            <ul class="list-none p-0 m-0">
                              <li class="flex px-3 mb-3 justify-between leading-[3.5rem] shadow-lg bg-black/20 rounded-md" x-data="{link: '{{ user.subscription_url }}'}">
                                    <span class="font-semibold flex-1 dark:text-gray-200 text-black cursor-default" x-text="$t('subscription')"></span>
                                    <div class="flex justify-between items-center">
                                        <!-- <a class="w-8 h-8 ltr:mr-3 rtl:ml-3 cursor-pointer" x-data x-show="settings.autoImportUserLink != ''" :href="settings.autoImportUserLink + '{{ user.subscription_url }}'">
                                            <svg fill="#000000" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="stroke-blue-600 dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors">
                                                <polyline id="primary" points="13 7 13 13 7 13" style="fill: none; "></polyline>
                                                <line id="primary-2" data-name="primary" x1="13" y1="13" x2="3" y2="3" style="fill: none; "></line>
                                                <path id="primary-3" data-name="primary" d="M13,3h7a1,1,0,0,1,1,1V20a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V13" style="fill: none; "></path>
                                            </svg>
                                        </a> -->
                                        <div class="w-8 h-8 ltr:mr-3 rtl:ml-3 cursor-pointer" x-data="{copyColor: 'stroke-blue-600'}" @click="() => { navigator.clipboard.writeText( '{{ user.subscription_url }}' ); copyColor = 'stroke-green-600'; setTimeout(() => copyColor = 'stroke-blue-600', 2000); }">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" class="dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors" :class="copyColor" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184" />
                                            </svg>
                                        </div>
                                        <div class="w-8 h-8 cursor-pointer qr-button" :data-link="link">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" class="stroke-blue-600 dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 013.75 9.375v-4.5zM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 01-1.125-1.125v-4.5zM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0113.5 9.375v-4.5z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 6.75h.75v.75h-.75v-.75zM6.75 16.5h.75v.75h-.75v-.75zM16.5 6.75h.75v.75h-.75v-.75zM13.5 13.5h.75v.75h-.75v-.75zM13.5 19.5h.75v.75h-.75v-.75zM19.5 13.5h.75v.75h-.75v-.75zM19.5 19.5h.75v.75h-.75v-.75zM16.5 16.5h.75v.75h-.75v-.75z" />
                                            </svg>
                                        </div>
                                    </div>
                                </li>
                                {% if user.status == 'active' %}
                                <!-- <div class="bg-black/20 rounded-md shadow-lg pt-3 pb-1"> -->
                                {% for link in user.links %}
                                <li class="flex px-3 mb-1 justify-between leading-[3.5rem] rounded-md transition duration-300" x-data="{link: '{{ link }}'}">
                                    <span class="font-semibold flex-1 dark:text-gray-200 text-black cursor-default" x-text="getRemark(link)"></span>
                                    <div class="flex justify-between items-center">
                                       <!--  <div class="w-8 h-8 ltr:mr-3 rtl:ml-3 cursor-pointer" x-data="{copyColor: 'stroke-blue-600'}" @click="() => { navigator.clipboard.writeText( link ); copyColor = 'stroke-green-600'; setTimeout(() => copyColor = 'stroke-blue-600', 2000); }">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" class="dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors" :class="copyColor" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184" />
                                            </svg>
                                        </div> -->
                                        <div class="w-8 h-8 cursor-pointer qr-button" :data-link="link">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" class="stroke-blue-600 dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 013.75 9.375v-4.5zM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 01-1.125-1.125v-4.5zM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0113.5 9.375v-4.5z" />
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 6.75h.75v.75h-.75v-.75zM6.75 16.5h.75v.75h-.75v-.75zM16.5 6.75h.75v.75h-.75v-.75zM13.5 13.5h.75v.75h-.75v-.75zM13.5 19.5h.75v.75h-.75v-.75zM19.5 13.5h.75v.75h-.75v-.75zM19.5 19.5h.75v.75h-.75v-.75zM16.5 16.5h.75v.75h-.75v-.75z" />
                                            </svg>
                                        </div>
                                    </div>
                                </li>
                               <!-- {% endfor %} -->
                              <li class="rounded-md m-3 shadow-lg transition duration-300 bg-blue-600 text-white text-center text-lg py-2 mt-3 cursor-pointer hover:shadow-2xl copyAllButton stroke-blue-600" x-text="$t('copyAll')"></li>
                                <!-- </div> -->
                                {{ user.subscription_url }}
                            </ul>
                        </div>
                        <div class="hidden" id="apps" role="tabpanel" aria-labelledby="apps-tab">
                            <div class="flex sm:flex-row flex-col">
                                <div class="sm:basis-1/5 sm:rtl:ml-4 sm:ltr:mr-4">
                                    <ul class="flex sm:flex-col text-sm font-medium text-center" id="apps-tab" data-tabs-toggle="#apps-tabs-content" role="tablist">
                                        <template x-for="item in Object.keys(appsJson)">
                                            <li class="flex-grow mb-2" role="presentation">
                                                <button class="inline-block p-4 border-b-2 rounded-t-lg w-full transition" :id="item + '-tab'" :data-tabs-target="'#' + item" type="button" role="tab" :aria-controls="item" aria-selected="false" x-text="item"></button>
                                            </li>
                                        </template>
                                    </ul>
                                </div>
                                <div id="apps-tabs-content" class="sm:basis-4/5">
                                    <template x-for="item in Object.keys(appsJson)">
                                        <div class="hidden" :id="item" role="tabpanel" :aria-labelledby="item + '-tab'">
                                            <ul class="list-none p-0 m-0">
                                                <template x-for="app in Object.keys(appsJson[item]).reverse()">
                                                    <template x-for="subApp in appsJson[item][app].url">
                                                        <li :class="subApp.best ? 'bg-green-600/30 shadow-lg' : 'hover:bg-black/10 hover:shadow-lg'" class="flex px-3 mb-1 justify-between leading-[3.5rem] rounded-md transition duration-300" x-data="{link: subApp.url}">
                                                            <div class="flex flex-row items-center space-x-3 rtl:space-x-reverse cursor-default">
                                                                <span class="font-semibold flex-1 dark:text-gray-200 text-black" x-text="app"></span>
                                                                <span :class="subApp.best ? 'dark:text-gray-200 text-gray-800' : 'text-gray-600'" class="text-sm" x-text="subApp.name"></span>
                                                            </div>
                                                            <div class="flex justify-between items-center">
                                                                <a class="w-8 h-8 ltr:mr-3 rtl:ml-3 cursor-pointer" x-show="appsJson[item][app].autoImport != ''" :data-tooltip-target="'tooltip-import-' + app" :href="appsJson[item][app].autoImport + '{{ user.subscription_url }}'" :data-title="app">
                                                                    <svg fill="#000000" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="stroke-blue-600 dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors">
                                                                        <polyline id="primary" points="13 7 13 13 7 13" style="fill: none; "></polyline>
                                                                        <line id="primary-2" data-name="primary" x1="13" y1="13" x2="3" y2="3" style="fill: none; "></line>
                                                                        <path id="primary-3" data-name="primary" d="M13,3h7a1,1,0,0,1,1,1V20a1,1,0,0,1-1,1H4a1,1,0,0,1-1-1V13" style="fill: none; "></path>
                                                                    </svg>
                                                                </a>
                                                                <div :id="'tooltip-import-' + app" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
                                                                    <span x-text="$t('import')"></span>
                                                                    <div class="tooltip-arrow" data-popper-arrow></div>
                                                                </div>
                                                                <a class="w-8 h-8 ltr:mr-3 rtl:ml-3 cursor-pointer video-button" x-show="appsJson[item][app].tutorial != ''" :data-tooltip-target="'tooltip-tutorial-' + app" :data-link="appsJson[item][app].tutorial" :data-title="app">
                                                                    <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="stroke-blue-600 dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors">
                                                                        <polygon points="23 7 16 12 23 17 23 7" />
                                                                        <rect height="14" rx="2" ry="2" width="15" x="1" y="5" />
                                                                    </svg>
                                                                </a>
                                                                <div :id="'tooltip-tutorial-' + app" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
                                                                    <span x-text="$t('tutorial')"></span>
                                                                    <div class="tooltip-arrow" data-popper-arrow></div>
                                                                </div>
                                                                <a class="w-8 h-8 cursor-pointer" :data-tooltip-target="'tooltip-download-' + app" :href="link" target="_blank">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" class="stroke-blue-600 dark:hover:stroke-gray-300 hover:stroke-gray-800 transition-colors" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3" />
                                                                    </svg>
                                                                </a>
                                                                <div :id="'tooltip-download-' + app" role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
                                                                    <span x-text="$t('download')"></span>
                                                                    <div class="tooltip-arrow" data-popper-arrow></div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </template>
                                                </template>
                                            </ul>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="popup" class="fixed w-fit min-w-[20rem] max-h-[95vh] h-fit p-10 pt-7 shadow-dialog-shadow dark:shadow-2xl rounded-lg top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-main-light dark:bg-main-dark hidden">
        <h2 class="h-10 leading-[2.5rem] mb-4 inline-block font-semibold text-gray-950 dark:text-white"></h2>
        <a class="close absolute ltr:right-10 rtl:left-10 top-7 text-3xl cursor-pointer dark:text-white text-gray-950">&times;</a>
        <div class="content rounded-lg max-h-[90%]"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.6.6/flowbite.min.js"></script>
    <script>
        let progressBar = {
            width: dataUsage,
            color: dataChartColor,
        };

        let qrSize = $( window ).width() > 500 ? ( $( window ).height() > 500 ? 400 : $( window ).height() - 200 ) : $( window ).height() > 500 ? $( window ).width() - 100 : $( window ).height() - 200;
        $( window ).resize( function ()
        {
            qrSize = $( window ).width() > 500 ? ( $( window ).height() > 500 ? 400 : $( window ).height() - 200 ) : $( window ).height() > 500 ? $( window ).width() - 100 : $( window ).height() - 200;
        } );

        const popup = $( "#popup" );
        const qrButtons = $( ".qr-button" );
        const popupClose = $( "#popup > a.close" ).on( "click", () =>
        {
            popup.toggleClass( "hidden" );
            $( "#popup > .content" ).removeClass( "bg-white p-5" ).html( "" );
            $( "#popup > h2" ).html( "" );
            $( "#page-container" ).removeClass( "blur-sm scale-110 -z-10" );
            setTimeout( () =>
            {
                $( document.body ).removeClass( "overflow-hidden" );
            }, 200 );
        } );

        qrButtons.each( ( i, elem ) =>
        {
            $( elem ).on( "click", () =>
            {
                const link = $( elem ).attr( "data-link" );
                $( "#popup > .content" ).addClass( "bg-white p-5" ).html( "" );
                $( "#popup > .content" ).qrcode( {
                    size: qrSize,
                    radius: 0.2,
                    text: link,
                    ecLevel: "H",
                } );
                $( document.body ).addClass( "overflow-hidden" );
                $( "#page-container" ).addClass( "blur-sm scale-110 -z-10" );
                $( "#popup > h2" ).html( getRemark( link ) );
                popup.removeClass( "hidden" );
            } );
        } );

        $( ".copyAllButton" ).on( "click", async ( a ) =>
        {
            let links = [];
            $( ".qr-button" ).each( ( i, ele ) =>
            {
                let link = $( ele ).attr( "data-link" );
                if ( !link.startsWith( "http" ) ) links.push( link );
            } );
            await navigator.clipboard.writeText( links.join( "\n" ) );
            var thisObj = $( a.target ).css( "background", "#16a34a" );
            setTimeout( () => thisObj.css( "background", "#2563eb" ), 1500 );
        } );

        document.addEventListener( "alpine:initialized", () =>
        {
            $( ".video-button" ).each( ( i, elem ) =>
            {
                $( elem ).on( "click", () =>
                {
                    const title = $( elem ).attr( "data-title" );
                    const link = $( elem ).attr( "data-link" );
                    $( document.body ).addClass( "overflow-hidden" );
                    $( "#page-container" ).addClass( "blur-sm scale-110 -z-10" );
                    $( "#popup > .content" ).html( "" );
                    let video = $( "<video>" ).attr( "controls", "" ).addClass( "rounded-lg" );
                    let source = $( "<source>" ).attr( { src: link, type: "video/mp4" } ).appendTo( video );
                    video.appendTo( "#popup > .content" );
                    $( "#popup > h2" ).html( title );
                    popup.removeClass( "hidden" );
                } );
            } );
        } );

        window.addEventListener( "alpine-i18n:locale-change", function ()
        {
            var locale = window.AlpineI18n.locale;
            document.body.setAttribute( "dir", locale == "fa" ? "rtl" : "ltr" );
            if ( locale == "fa" ) $( document.body ).addClass( "font-[vazirmatn]" );
            else $( document.body ).removeClass( "font-[vazirmatn]" );
        } );

        function getRemark ( link )
        {
            if ( link.startsWith( "http" ) ) return AlpineI18n.t( "subscription" );
            if ( link.includes( "vmess://" ) )
            {
                const config = JSON.parse( atob( link.replace( "vmess://", "" ) ) );
                return config.ps;
            } else return decodeURIComponent( link.split( "#" )[ 1 ] );
        }

        function changeLang ( ele )
        {
            localStorage.setItem( "lang", ele.value );
            window.AlpineI18n.locale = ele.value;
            document.body.setAttribute( "dir", ele.value == "fa" ? "rtl" : "ltr" );
            if ( ele.value == "fa" ) $( document.body ).addClass( "font-[Vazirmatn]" );
            else $( document.body ).removeClass( "font-[Vazirmatn]" );
        }

        function changeTheme ( ele )
        {
            settings.darkMode = ele.checked ? 1 : 0;
            localStorage.setItem( "dark", settings.darkMode );
            if ( !ele.checked ) $( document.body ).removeClass( "dark" );
            else $( document.body ).addClass( "dark" );
        }

        function openSettings ()
        {
            $( document.body ).addClass( "overflow-hidden" );
            $( "#page-container" ).addClass( "blur-sm scale-110 -z-10" );
            var content = $( "#popup > .content" );
            $(
                `<label for="default" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">` +
                AlpineI18n.t( "language" ) +
                `</label>
<select id="default" class="bg-gray-50 border border-gray-300 text-gray-900 mb-6 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" onchange="changeLang(this)">
  <option value="en"` +
                ( AlpineI18n.locale == "en" ? " selected" : "" ) +
                `>English</option>
  <option value="fa"` +
                ( AlpineI18n.locale == "fa" ? " selected" : "" ) +
                `>فارسی</option>
  <option value="ru"` +
                ( AlpineI18n.locale == "ru" ? " selected" : "" ) +
                `>Русский</option>
</select>
<label class="relative flex justify-between items-center cursor-pointer">
  <input type="checkbox" value="" class="sr-only peer"` +
                ( settings.darkMode == 1 ? " checked" : "" ) +
                ` onchange="changeTheme(this)">
  <span class="text-sm font-medium text-gray-900 dark:text-white">` +
                AlpineI18n.t( "darkMode" ) +
                `</span>
  <div class="w-11 h-6 relative bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
</label>
`,
            ).appendTo( content );
            $( "#popup > h2" ).html( AlpineI18n.t( "settings" ) );
            popup.removeClass( "hidden" );
        }
    </script>
      
    
</body>

</html>
